

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Areis">
  <meta name="keywords" content="">
  
    <meta name="description" content="Docker 的出现，改变了以前传统开发部署运帷的繁琐步骤。作为新时代的开发者，必须掌握这门技术。课程来源：bilibili 遇见狂神说 Docker 概述Docker 为什么出现？ 开发运维环境不同，换设备就不能运行 希望项目能带上环境一起打包 更方便的配置集群 开发步骤 传统：开发 jar，运维来做 现在：开发、打包、部署、上线   Docker 给出了解决方案    类似于集装箱 Docke">
<meta property="og:type" content="article">
<meta property="og:title" content="2020-12-07-Docker教程">
<meta property="og:url" content="https://polarisink.github.io/2022/08/13/yuque/2020-12-07-Docker%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Docker 的出现，改变了以前传统开发部署运帷的繁琐步骤。作为新时代的开发者，必须掌握这门技术。课程来源：bilibili 遇见狂神说 Docker 概述Docker 为什么出现？ 开发运维环境不同，换设备就不能运行 希望项目能带上环境一起打包 更方便的配置集群 开发步骤 传统：开发 jar，运维来做 现在：开发、打包、部署、上线   Docker 给出了解决方案    类似于集装箱 Docke">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201129203718200.png#crop=0&crop=0&crop=1&crop=1&id=xdJ6O&originHeight=90&originWidth=540&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201129213326832.png#crop=0&crop=0&crop=1&crop=1&id=x8A9H&originHeight=696&originWidth=1320&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201130102034244.png#crop=0&crop=0&crop=1&crop=1&id=U2XZm&originHeight=1102&originWidth=1462&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201130104015267.png#crop=0&crop=0&crop=1&crop=1&id=p2B5D&originHeight=854&originWidth=2088&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/d5fb0a69743f965c303b88d822ddfd04.png#crop=0&crop=0&crop=1&crop=1&id=woCwT&originHeight=500&originWidth=917&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201130200435173.png#crop=0&crop=0&crop=1&crop=1&id=UI25N&originHeight=874&originWidth=1262&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201201122158744.png#crop=0&crop=0&crop=1&crop=1&id=ptgKm&originHeight=574&originWidth=1258&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bqc2RzZw==,size_16,color_FFFFFF,t_70.png#crop=0&crop=0&crop=1&crop=1&id=RonQg&originHeight=230&originWidth=309&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201201213837893.png#crop=0&crop=0&crop=1&crop=1&id=RZYCO&originHeight=622&originWidth=862&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/be92f97487fe2d254f4fd40da4985239.jpg#crop=0&crop=0&crop=1&crop=1&id=QRHKh&originHeight=407&originWidth=724&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201202130933453.png#crop=0&crop=0&crop=1&crop=1&id=CTEsg&originHeight=1254&originWidth=1300&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201202131332942.png#crop=0&crop=0&crop=1&crop=1&id=vVzwM&originHeight=694&originWidth=1522&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201202145821191.png#crop=0&crop=0&crop=1&crop=1&id=klhRw&originHeight=344&originWidth=778&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204192104227.png#crop=0&crop=0&crop=1&crop=1&id=zXqBf&originHeight=214&originWidth=2042&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204203129431.png#crop=0&crop=0&crop=1&crop=1&id=GTRyv&originHeight=810&originWidth=1832&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204205802117.png#crop=0&crop=0&crop=1&crop=1&id=P92DG&originHeight=474&originWidth=1922&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204205857887.png#crop=0&crop=0&crop=1&crop=1&id=pnkXj&originHeight=558&originWidth=1922&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204212214535.png#crop=0&crop=0&crop=1&crop=1&id=H5faj&originHeight=760&originWidth=1014&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201205113928051.png#crop=0&crop=0&crop=1&crop=1&id=BqF9R&originHeight=722&originWidth=1176&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="og:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201205115029255.png#crop=0&crop=0&crop=1&crop=1&id=lEBk9&originHeight=728&originWidth=1180&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
<meta property="article:published_time" content="2022-08-13T13:39:15.000Z">
<meta property="article:modified_time" content="2022-10-10T02:47:10.708Z">
<meta property="article:author" content="Areis">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201129203718200.png#crop=0&crop=0&crop=1&crop=1&id=xdJ6O&originHeight=90&originWidth=540&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=">
  
  
  
  <title>2020-12-07-Docker教程 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"polarisink.github.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>北辰的笔墨</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2020-12-07-Docker教程"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-13 21:39" pubdate>
          2022年8月13日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          43k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          359 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2020-12-07-Docker教程</h1>
            
            
              <div class="markdown-body">
                
                <p>Docker 的出现，改变了以前传统开发部署运帷的繁琐步骤。作为新时代的开发者，必须掌握这门技术。<br>课程来源：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1og4y1q7M4?p=1">bilibili 遇见狂神说</a></p>
<h1><span id="docker-概述">Docker 概述</span></h1><h2><span id="docker-为什么出现">Docker 为什么出现？</span></h2><ul>
<li>开发运维环境不同，换设备就不能运行</li>
<li>希望项目能带上环境一起打包</li>
<li>更方便的配置集群</li>
<li>开发步骤<ul>
<li>传统：开发 jar，运维来做</li>
<li>现在：开发、打包、部署、上线</li>
</ul>
</li>
<li>Docker 给出了解决方案</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201129203718200.png#crop=0&crop=0&crop=1&crop=1&id=xdJ6O&originHeight=90&originWidth=540&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>类似于集装箱</li>
<li>Docker 通过隔离机制将服务器利用到极致</li>
<li>本质：需求驱动技术</li>
</ul>
<h2><span id="docker-历史">Docker 历史</span></h2><ul>
<li>2010 年，几个年轻人成立一家公司 dotCloud，做一些云计算业务，有容器技术</li>
<li>经验遇到困难之后，2013 年将 Docker 开源</li>
<li>2014 年 4 月 9 日，Docker1.0 发布</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">vm: 需要下载 linux 镜像，体积大，配置要求高，启动慢，笨重；<br>docker: 隔离，寄生于宿主机，配置要求低，启动快，小巧。<br></code></pre></td></tr></table></figure>

<ul>
<li>Docker 基于 Go 语言开发</li>
<li>官网：<a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com/</a></li>
<li>文档地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a></li>
<li>仓库地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></li>
</ul>
<blockquote>
<p>DevOps（开发、运维）</p>
</blockquote>
<p><strong>应用更快速的交互和部署</strong></p>
<p>传统：一堆帮助文档，安装程序</p>
<p>Docker：打包镜像发布测试，一件运行</p>
<p><strong>更快捷的升级和扩缩容</strong></p>
<p>部署应用就像搭积木</p>
<p>项目打包为镜像，扩展，服务器 A，服务器 B</p>
<p><strong>更简单的系统运维</strong></p>
<p>开发测试环境高度一致</p>
<p><strong>更高效的计算资源利用</strong></p>
<p>Docker 是内核级虚拟化，一个物理机可运行很多容器实例</p>
<h1><span id="docker-安装">Docker 安装</span></h1><h2><span id="docker-基本组成">Docker 基本组成</span></h2><p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201129213326832.png#crop=0&crop=0&crop=1&crop=1&id=x8A9H&originHeight=696&originWidth=1320&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h3><span id="镜像image">镜像（image）</span></h3><blockquote>
<p>一个模板，可以通过这个模板来创建容器服务。tomcat 镜像&#x3D;&#x3D; &gt;run&#x3D;&#x3D;&#x3D;&gt;tomcat01 容器，通过这个惊喜可以创建多个容器</p>
</blockquote>
<h3><span id="容器container">容器（container）</span></h3><blockquote>
<p>Docker 利用容器技术，独立运行一个或一组应用</p>
</blockquote>
<h3><span id="仓库repository">仓库（repository）</span></h3><blockquote>
<p>存放镜像的地方。分为共有仓库和私有仓库</p>
<p>Docker Hub 默认为国外的，可以使用国内地址加速</p>
</blockquote>
<h2><span id="安装-docker">安装 Docker</span></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">官网：https://docs.docker.com/get-docker/</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Mac</span><br>brew cask install docker<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Centos</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">卸载老版本</span><br>sudo yum remove docker \<br>                  docker-client \<br>                  docker-client-latest \<br>                  docker-common \<br>                  docker-latest \<br>                  docker-latest-logrotate \<br>                  docker-logrotate \<br>                  docker-engine<br><span class="hljs-meta prompt_"># </span><span class="language-bash">设置存储库</span><br>sudo yum install -y yum-utils<br>sudo yum-config-manager \<br>    --add-repo \<br>    https://download.docker.com/linux/centos/docker-ce.repo<br><span class="hljs-meta prompt_"># </span><span class="language-bash">安装Docker引擎</span><br>sudo yum install docker-ce docker-ce-cli containerd.io<br><span class="hljs-meta prompt_"># </span><span class="language-bash">安装docker-compose</span><br>sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.27.4/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose<br>sudo chmod +x /usr/local/bin/docker-compose<br>sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose<br><span class="hljs-meta prompt_"># </span><span class="language-bash">启动Docker</span><br>sudo systemctl start docker<br><span class="hljs-meta prompt_"># </span><span class="language-bash">运行hello-world</span><br>sudo docker run hello-world<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">镜像加速</span><br>sudo mkdir -p /etc/docker<br>sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;<br>&#123;<br>  &quot;registry-mirrors&quot;: [&quot;https://qtpwk07g.mirror.aliyuncs.com&quot;]<br>&#125;<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure>

<h2><span id="helloworld-流程">HelloWorld 流程</span></h2><p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201130102034244.png#crop=0&crop=0&crop=1&crop=1&id=U2XZm&originHeight=1102&originWidth=1462&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h2><span id="底层原理">底层原理</span></h2><ul>
<li>Docker 是一个 Server-Client 架构的系统，Docker 守护进程运行在主机上，通过 Client 访问</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201130104015267.png#crop=0&crop=0&crop=1&crop=1&id=p2B5D&originHeight=854&originWidth=2088&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>为什么 Docker 比 VM 快？<ul>
<li>Docker 有着比虚拟机更少的抽象层</li>
<li>Docker 利用宿主机内核，VM 需要 Guest OS</li>
</ul>
</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/d5fb0a69743f965c303b88d822ddfd04.png#crop=0&crop=0&crop=1&crop=1&id=woCwT&originHeight=500&originWidth=917&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>Docker &amp;&amp; LXC &amp;&amp; VM 对比<table>
<thead>
<tr>
<th></th>
<th>Docker 容器</th>
<th>LXC</th>
<th>VM</th>
</tr>
</thead>
<tbody><tr>
<td>虚拟化类型</td>
<td>OS 虚拟化</td>
<td>OS 虚拟化</td>
<td>硬件虚拟化</td>
</tr>
<tr>
<td>性能</td>
<td>物理机性能</td>
<td>物理机性能</td>
<td>5%–20%损耗</td>
</tr>
<tr>
<td>隔离型</td>
<td>NS 隔离</td>
<td>NS 隔离</td>
<td>强</td>
</tr>
<tr>
<td>QoS</td>
<td>Cgroup 弱</td>
<td>Cgroup 弱</td>
<td>强</td>
</tr>
<tr>
<td>安全性</td>
<td>中</td>
<td>差</td>
<td>强</td>
</tr>
<tr>
<td>GuestOS</td>
<td>全部</td>
<td>只支持 Linux</td>
<td>全部</td>
</tr>
<tr>
<td>可迁移性</td>
<td>强</td>
<td>弱</td>
<td>强</td>
</tr>
</tbody></table>
</li>
</ul>
<h1><span id="docker-常用命令">Docker 常用命令</span></h1><h2><span id="帮助命令">帮助命令</span></h2><p>帮助文档地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/">https://docs.docker.com/engine/reference/commandline/</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看版本信息</span><br>docker version<br><span class="hljs-meta prompt_"># </span><span class="language-bash">显示docker系统信息，包括镜像</span><br>docker info<br><span class="hljs-meta prompt_"># </span><span class="language-bash">万能命令</span><br>docker 命令 --help<br></code></pre></td></tr></table></figure>

<h2><span id="镜像命令">镜像命令</span></h2><h3><span id="docker-images">docker images</span></h3><ul>
<li>查看本地所有主机上的镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker images<br>REPOSITORY    TAG       IMAGE ID       CREATED         SIZE<br>mysql         latest    dd7265748b5d   9 days ago      545MB<br>hello-world   latest    bf756fb1ae65   11 months ago   13.3kB<br><span class="hljs-meta prompt_"># </span><span class="language-bash">可选项</span><br>	-a, -all				# 列出所有镜像<br>	-q, -quiet			# 只显示镜像id<br></code></pre></td></tr></table></figure>

<h3><span id="docker-search">docker search</span></h3><ul>
<li>搜索镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker search mysql<br>NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED<br>mysql                             MySQL is a widely used, open-source relation…   10202     [OK]<br>mariadb                           MariaDB is a community-developed fork of MyS…   3753      [OK]<br>mysql/mysql-server                Optimized MySQL Server Docker images. Create…   746                  [OK]<br>percona                           Percona Server is a fork of the MySQL relati…   511       [OK]<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">可选项</span><br>	--filter=STARS=3000		# 搜索出来的镜像STARS大于3000<br></code></pre></td></tr></table></figure>

<h3><span id="docker-pull">docker pull</span></h3><ul>
<li>下载镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker pull tomcat<br>Using default tag: latest<br>latest: Pulling from library/tomcat	# 不写tag默认为latest<br>756975cb9c7e: Pull complete		# 分层下载，docker image的核心，联合文件系统<br>d77915b4e630: Pull complete<br>5f37a0a41b6b: Pull complete<br>96b2c1e36db5: Pull complete<br>27a2d52b526e: Pull complete<br>a867dba77389: Pull complete<br>0939c055fb79: Pull complete<br>0b0694ce0ae2: Pull complete<br>81a5f8099e05: Pull complete<br>c3d7917d545e: Pull complete<br>Digest: sha256:a319b10d8729817c7ce0bcc2343a6f97711c7870395019340d96b6aafd6ccbea		# 签名<br>Status: Downloaded newer image for tomcat:latest<br>docker.io/library/tomcat:latest		#真实地址<br><br>docker pull tomcat === docker pull docker.io/library/tomcat:latest<br><br><br>[root@server1 ~]# docker pull mysql:5.7<br>5.7: Pulling from library/mysql<br>852e50cd189d: Already exists		# 联合文件系统，已存在的不需要再下载<br>29969ddb0ffb: Already exists<br>a43f41a44c48: Already exists<br>5cdd802543a3: Already exists<br>b79b040de953: Already exists<br>938c64119969: Already exists<br>7689ec51a0d9: Already exists<br>36bd6224d58f: Pull complete<br>cab9d3fa4c8c: Pull complete<br>1b741e1c47de: Pull complete<br>aac9d11987ac: Pull complete<br>Digest: sha256:8e2004f9fe43df06c3030090f593021a5f283d028b5ed5765cc24236c2c4d88e<br>Status: Downloaded newer image for mysql:5.7<br>docker.io/library/mysql:5.7<br></code></pre></td></tr></table></figure>

<h3><span id="docker-rmi">docker rmi</span></h3><ul>
<li>删除镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">删除指定<span class="hljs-built_in">id</span>的镜像</span><br>[root@server1 ~]# docker rmi -f ae0658fdbad5<br>Untagged: mysql:5.7<br>Untagged: mysql@sha256:8e2004f9fe43df06c3030090f593021a5f283d028b5ed5765cc24236c2c4d88e<br>Deleted: sha256:ae0658fdbad5fb1c9413c998d8a573eeb5d16713463992005029c591e6400d02<br>Deleted: sha256:a2cf831f4221764f4484ff0df961b54f1f949ed78220de1b24046843c55ac40f<br>Deleted: sha256:0a7adcc95a91b1ec2beab283e0bfce5ccd6df590bd5a5e894954fcf27571e7f5<br>Deleted: sha256:0fae465cbacf7c99aa90bc286689bc88a35d086f37fd931e03966d312d5dfb10<br>Deleted: sha256:23af125b9e54a94c064bdfacc2414b1c8fba288aff48308e8117beb08b38cb19<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除多个镜像</span><br>[root@server1 ~]# docker rmi -f imageid1, imageid2,imageid3<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除所有镜像</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">可命令嵌套</span><br>[root@server1 ~]# docker rmi -f $(docker images -aq)<br></code></pre></td></tr></table></figure>

<h2><span id="容器命令">容器命令</span></h2><h3><span id="docker-run">docker run</span></h3><ul>
<li>开启新容器并运行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">先ntos镜像</span><br>docker pull centos<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">新建容器并启动</span><br>docker run [可选参数] image<br><span class="hljs-meta prompt_"># </span><span class="language-bash">参数说明</span><br>	--name=&quot;Name&quot;		# 指定容器名字<br>	-d							# 后台方式运行<br>	-i							# 使用交互方式运行，进入容器查看内容<br>	-p							# 指定容器端口<br>  				-p ip:主机端口 : 容器端口<br>          -p 主机端口 : 容器端口<br>  				-p 容器端口<br>	-P							# 指定随机端口<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">测试、启动并进入容器</span><br>[root@server1 ~]# docker run -it centos /bin/bash<br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用</span><br>[root@cd3299fcc032 /]# ls<br>bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var<br>dev  home  lib64  media       opt  root  sbin  sys  usr<br></code></pre></td></tr></table></figure>

<h3><span id="docker-ps">docker ps</span></h3><ul>
<li>查看运行的容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看正在运行的容器</span><br>[root@server1 ~]# docker ps [可选参数<br>CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES<br>	-a		# 示所有容器<br>	-n=7	# 显示最近7个容器<br></code></pre></td></tr></table></figure>

<h3><span id="exit">exit</span></h3><ul>
<li>退出</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">退出容器且停止运行</span><br>[root@cd3299fcc032 opt]# exit<br>exit<br><span class="hljs-meta prompt_"># </span><span class="language-bash">退出容器且继续运行</span><br>Ctrl + P + Q<br></code></pre></td></tr></table></figure>

<h3><span id="docker-rm">docker rm</span></h3><ul>
<li>删除容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">删除指定<span class="hljs-built_in">id</span>容器</span><br>docker rm 容器id<br>	-f	# 强制执行<br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除所有容器</span><br>docker rm -f $(docker ps -aq)<br>docker ps -a -q | xargs docker rm<br></code></pre></td></tr></table></figure>

<h3><span id="docker-startx2frestartx2fstopx2fkill">docker start&#x2F;restart&#x2F;stop&#x2F;kill</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">启动容器</span><br>docker start 容器id<br><span class="hljs-meta prompt_"># </span><span class="language-bash">重启容器</span><br>docker restart 容器id<br><span class="hljs-meta prompt_"># </span><span class="language-bash">停止当前正在运行的容器</span><br>docker stop 容器id<br><span class="hljs-meta prompt_"># </span><span class="language-bash">强制停止当前容器</span><br>docker kill 容器id<br></code></pre></td></tr></table></figure>

<h2><span id="其他常用">其他常用</span></h2><h3><span id="1-后台启动容器">1、后台启动容器</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker run -d centos<br>a2e2c9f87dc9dea7a04221c4e159a71364e752cb572ee8c6a9722defc2a9713f<br>[root@server1 ~]# docker ps<br>CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES<br>[root@server1 ~]#<br><span class="hljs-meta prompt_"># </span><span class="language-bash">常见的坑：docker容器使用后台运行，必须有一个前台进程。docker没有发现应用，就自动停止</span><br></code></pre></td></tr></table></figure>

<h3><span id="2-查看日志">2、查看日志</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker logs --help<br>Usage:  docker logs [OPTIONS] CONTAINER<br>Fetch the logs of a container<br><br>Options:<br>      --details        Show extra details provided to logs<br>  -f, --follow         Follow log output<br>      --since string   Show logs since timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)<br>  -n, --tail string    Number of lines to show from the end of the logs (default &quot;all&quot;)<br>  -t, --timestamps     Show timestamps<br>      --until string   Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)<br><br>[root@server1 ~]# docker run -d centos /bin/sh -c &quot;while true;do echo lqs;sleep 1;done&quot;<br>1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094<br>[root@server1 ~]# docker ps<br>CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES<br>1d99006b4363   centos    &quot;/bin/sh -c &#x27;while t…&quot;   4 seconds ago   Up 2 seconds             sweet_pascal<br>4a48763c24a9   centos    &quot;/bin/sh -c &#x27;while t…&quot;   2 minutes ago   Up 2 minutes             cool_knuth<br>[root@server1 ~]# docker logs -tf --tail 10 1d99006b4363<br>2020-11-30T06:24:34.441977721Z lqs<br>2020-11-30T06:24:35.459814107Z lqs<br>2020-11-30T06:24:36.487265008Z lqs<br>2020-11-30T06:24:37.508551064Z lqs<br>2020-11-30T06:24:38.526719550Z lqs<br></code></pre></td></tr></table></figure>

<h3><span id="3-查看进程信息">3、查看进程信息</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker top 1d99006b4363<br>UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD<br>root                476469              476326              0                   14:24               ?                   00:00:00            /bin/sh -c while true;do echo lqs;sleep 1;done<br>root                583733              476469              0                   14:29               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1<br></code></pre></td></tr></table></figure>

<h3><span id="4-查看元数据">4、查看元数据</span></h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><br>[root<span class="hljs-symbol">@server1</span> ~]<span class="hljs-meta"># docker inspect 1d99006b4363</span><br>[<br>    &#123;<br>        <span class="hljs-string">&quot;Id&quot;</span>: <span class="hljs-string">&quot;1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094&quot;</span>,<br>        <span class="hljs-string">&quot;Created&quot;</span>: <span class="hljs-string">&quot;2020-11-30T06:24:24.660296498Z&quot;</span>,<br>        <span class="hljs-string">&quot;Path&quot;</span>: <span class="hljs-string">&quot;/bin/sh&quot;</span>,<br>        <span class="hljs-string">&quot;Args&quot;</span>: [<br>            <span class="hljs-string">&quot;-c&quot;</span>,<br>            <span class="hljs-string">&quot;while true;do echo lqs;sleep 1;done&quot;</span><br>        ],<br>        <span class="hljs-string">&quot;State&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Status&quot;</span>: <span class="hljs-string">&quot;running&quot;</span>,<br>            <span class="hljs-string">&quot;Running&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;Paused&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Restarting&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OOMKilled&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Dead&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Pid&quot;</span>: <span class="hljs-number">476469</span>,<br>            <span class="hljs-string">&quot;ExitCode&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;Error&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;StartedAt&quot;</span>: <span class="hljs-string">&quot;2020-11-30T06:24:26.324713861Z&quot;</span>,<br>            <span class="hljs-string">&quot;FinishedAt&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;sha256:0d120b6ccaa8c5e149176798b3501d4dd1885f961922497cd0abef155c869566&quot;</span>,<br>        <span class="hljs-string">&quot;ResolvConfPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094/resolv.conf&quot;</span>,<br>        <span class="hljs-string">&quot;HostnamePath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094/hostname&quot;</span>,<br>        <span class="hljs-string">&quot;HostsPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094/hosts&quot;</span>,<br>        <span class="hljs-string">&quot;LogPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094/1d99006b4363eabcf1f33e5eec16fd45059dd5cdd400e6e05b3300fcd7b5e094-json.log&quot;</span>,<br>        <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;/sweet_pascal&quot;</span>,<br>        <span class="hljs-string">&quot;RestartCount&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;Driver&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span>,<br>        <span class="hljs-string">&quot;Platform&quot;</span>: <span class="hljs-string">&quot;linux&quot;</span>,<br>        <span class="hljs-string">&quot;MountLabel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;ProcessLabel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;AppArmorProfile&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;ExecIDs&quot;</span>: <span class="hljs-literal">null</span>,<br>        <span class="hljs-string">&quot;HostConfig&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Binds&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;ContainerIDFile&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;LogConfig&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;Type&quot;</span>: <span class="hljs-string">&quot;json-file&quot;</span>,<br>                <span class="hljs-string">&quot;Config&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;NetworkMode&quot;</span>: <span class="hljs-string">&quot;default&quot;</span>,<br>            <span class="hljs-string">&quot;PortBindings&quot;</span>: &#123;&#125;,<br>            <span class="hljs-string">&quot;RestartPolicy&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;no&quot;</span>,<br>                <span class="hljs-string">&quot;MaximumRetryCount&quot;</span>: <span class="hljs-number">0</span><br>            &#125;,<br>            <span class="hljs-string">&quot;AutoRemove&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;VolumeDriver&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;VolumesFrom&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CapAdd&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CapDrop&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CgroupnsMode&quot;</span>: <span class="hljs-string">&quot;host&quot;</span>,<br>            <span class="hljs-string">&quot;Dns&quot;</span>: [],<br>            <span class="hljs-string">&quot;DnsOptions&quot;</span>: [],<br>            <span class="hljs-string">&quot;DnsSearch&quot;</span>: [],<br>            <span class="hljs-string">&quot;ExtraHosts&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;GroupAdd&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;IpcMode&quot;</span>: <span class="hljs-string">&quot;private&quot;</span>,<br>            <span class="hljs-string">&quot;Cgroup&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Links&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;OomScoreAdj&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;PidMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Privileged&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;PublishAllPorts&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ReadonlyRootfs&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;SecurityOpt&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;UTSMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;UsernsMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;ShmSize&quot;</span>: <span class="hljs-number">67108864</span>,<br>            <span class="hljs-string">&quot;Runtime&quot;</span>: <span class="hljs-string">&quot;runc&quot;</span>,<br>            <span class="hljs-string">&quot;ConsoleSize&quot;</span>: [<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-number">0</span><br>            ],<br>            <span class="hljs-string">&quot;Isolation&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;CpuShares&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;Memory&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;NanoCpus&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CgroupParent&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;BlkioWeight&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;BlkioWeightDevice&quot;</span>: [],<br>            <span class="hljs-string">&quot;BlkioDeviceReadBps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;BlkioDeviceWriteBps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;BlkioDeviceReadIOps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;BlkioDeviceWriteIOps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CpuPeriod&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuQuota&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuRealtimePeriod&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuRealtimeRuntime&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpusetCpus&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;CpusetMems&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Devices&quot;</span>: [],<br>            <span class="hljs-string">&quot;DeviceCgroupRules&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;DeviceRequests&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;KernelMemory&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;KernelMemoryTCP&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MemoryReservation&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MemorySwap&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MemorySwappiness&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;OomKillDisable&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;PidsLimit&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Ulimits&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CpuCount&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuPercent&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;IOMaximumIOps&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;IOMaximumBandwidth&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MaskedPaths&quot;</span>: [<br>                <span class="hljs-string">&quot;/proc/asound&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/acpi&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/kcore&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/keys&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/latency_stats&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/timer_list&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/timer_stats&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sched_debug&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/scsi&quot;</span>,<br>                <span class="hljs-string">&quot;/sys/firmware&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;ReadonlyPaths&quot;</span>: [<br>                <span class="hljs-string">&quot;/proc/bus&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/fs&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/irq&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sys&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sysrq-trigger&quot;</span><br>            ]<br>        &#125;,<br>        <span class="hljs-string">&quot;GraphDriver&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Data&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;LowerDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/e43e6b4eee920ace4ce359c795615e673ba50bb70cee790a86d8feb26c999fa9-init/diff:/var/lib/docker/overlay2/591ddae90babb77b4ea29561acc558e678b309edbb5b91112a566c9c1fb48367/diff&quot;</span>,<br>                <span class="hljs-string">&quot;MergedDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/e43e6b4eee920ace4ce359c795615e673ba50bb70cee790a86d8feb26c999fa9/merged&quot;</span>,<br>                <span class="hljs-string">&quot;UpperDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/e43e6b4eee920ace4ce359c795615e673ba50bb70cee790a86d8feb26c999fa9/diff&quot;</span>,<br>                <span class="hljs-string">&quot;WorkDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/e43e6b4eee920ace4ce359c795615e673ba50bb70cee790a86d8feb26c999fa9/work&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Mounts&quot;</span>: [],<br>        <span class="hljs-string">&quot;Config&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Hostname&quot;</span>: <span class="hljs-string">&quot;1d99006b4363&quot;</span>,<br>            <span class="hljs-string">&quot;Domainname&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;User&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;AttachStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStdout&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStderr&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Tty&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OpenStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;StdinOnce&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Env&quot;</span>: [<br>                <span class="hljs-string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Cmd&quot;</span>: [<br>                <span class="hljs-string">&quot;/bin/sh&quot;</span>,<br>                <span class="hljs-string">&quot;-c&quot;</span>,<br>                <span class="hljs-string">&quot;while true;do echo lqs;sleep 1;done&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;centos&quot;</span>,<br>            <span class="hljs-string">&quot;Volumes&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;WorkingDir&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Entrypoint&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;OnBuild&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Labels&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;org.label-schema.build-date&quot;</span>: <span class="hljs-string">&quot;20200809&quot;</span>,<br>                <span class="hljs-string">&quot;org.label-schema.license&quot;</span>: <span class="hljs-string">&quot;GPLv2&quot;</span>,<br>                <span class="hljs-string">&quot;org.label-schema.name&quot;</span>: <span class="hljs-string">&quot;CentOS Base Image&quot;</span>,<br>                <span class="hljs-string">&quot;org.label-schema.schema-version&quot;</span>: <span class="hljs-string">&quot;1.0&quot;</span>,<br>                <span class="hljs-string">&quot;org.label-schema.vendor&quot;</span>: <span class="hljs-string">&quot;CentOS&quot;</span><br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;NetworkSettings&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Bridge&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;SandboxID&quot;</span>: <span class="hljs-string">&quot;b7d79cfaf7ee2a80d7186625f73561987096a77d40022d9da8a15325f833908e&quot;</span>,<br>            <span class="hljs-string">&quot;HairpinMode&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;LinkLocalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;LinkLocalIPv6PrefixLen&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;Ports&quot;</span>: &#123;&#125;,<br>            <span class="hljs-string">&quot;SandboxKey&quot;</span>: <span class="hljs-string">&quot;/var/run/docker/netns/b7d79cfaf7ee&quot;</span>,<br>            <span class="hljs-string">&quot;SecondaryIPAddresses&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;SecondaryIPv6Addresses&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;EndpointID&quot;</span>: <span class="hljs-string">&quot;82568b40df9a9923ae2599d54adba35f7231ee42f1712781da5549e5333a4332&quot;</span>,<br>            <span class="hljs-string">&quot;Gateway&quot;</span>: <span class="hljs-string">&quot;172.18.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;GlobalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;GlobalIPv6PrefixLen&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;IPAddress&quot;</span>: <span class="hljs-string">&quot;172.18.0.3&quot;</span>,<br>            <span class="hljs-string">&quot;IPPrefixLen&quot;</span>: <span class="hljs-number">16</span>,<br>            <span class="hljs-string">&quot;IPv6Gateway&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;MacAddress&quot;</span>: <span class="hljs-string">&quot;02:42:ac:12:00:03&quot;</span>,<br>            <span class="hljs-string">&quot;Networks&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;bridge&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;IPAMConfig&quot;</span>: <span class="hljs-literal">null</span>,<br>                    <span class="hljs-string">&quot;Links&quot;</span>: <span class="hljs-literal">null</span>,<br>                    <span class="hljs-string">&quot;Aliases&quot;</span>: <span class="hljs-literal">null</span>,<br>                    <span class="hljs-string">&quot;NetworkID&quot;</span>: <span class="hljs-string">&quot;fc51f6980ccad65f81ddef3584c7a7f3b80df21521fc322d204f1eaf9b9383a0&quot;</span>,<br>                    <span class="hljs-string">&quot;EndpointID&quot;</span>: <span class="hljs-string">&quot;82568b40df9a9923ae2599d54adba35f7231ee42f1712781da5549e5333a4332&quot;</span>,<br>                    <span class="hljs-string">&quot;Gateway&quot;</span>: <span class="hljs-string">&quot;172.18.0.1&quot;</span>,<br>                    <span class="hljs-string">&quot;IPAddress&quot;</span>: <span class="hljs-string">&quot;172.18.0.3&quot;</span>,<br>                    <span class="hljs-string">&quot;IPPrefixLen&quot;</span>: <span class="hljs-number">16</span>,<br>                    <span class="hljs-string">&quot;IPv6Gateway&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;GlobalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;GlobalIPv6PrefixLen&quot;</span>: <span class="hljs-number">0</span>,<br>                    <span class="hljs-string">&quot;MacAddress&quot;</span>: <span class="hljs-string">&quot;02:42:ac:12:00:03&quot;</span>,<br>                    <span class="hljs-string">&quot;DriverOpts&quot;</span>: <span class="hljs-literal">null</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>]<br></code></pre></td></tr></table></figure>

<h3><span id="5-进入当前正在运行的容器">5、进入当前正在运行的容器</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">方式一</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">一般后台运行，需要进入容器修改一些配置</span><br>[root@server1 ~]# docker exec -it 1d99006b4363 /bin/bash<br>		- exec	# 进入容器<br>		-it			# 交互模式<br>[root@1d99006b4363 /]# ls<br>bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var<br>dev  home  lib64  media       opt  root  sbin  sys  usr<br>[root@1d99006b4363 /]# ps -ef<br>UID          PID    PPID  C STIME TTY          TIME CMD<br>root           1       0  0 06:24 ?        00:00:00 /bin/sh -c while true;do<br>root         847       0  0 06:38 pts/0    00:00:00 /bin/bash<br>root         926       1  0 06:39 ?        00:00:00 /usr/bin/coreutils --cor<br>root         927     847  0 06:39 pts/0    00:00:00 ps -ef<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">方式二</span><br>[root@server1 ~]# docker attach 1d99006b4363<br>lqs<br>lqs<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">比较</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">docker <span class="hljs-built_in">exec</span>				进入容器后开启新终端，可以直接操作</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">docker attach			进入容器正在执行的终端，不会启动新进程</span><br></code></pre></td></tr></table></figure>

<h3><span id="6-从容器拷贝文件到主机">6、从容器拷贝文件到主机</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">docker <span class="hljs-built_in">cp</span> 2973e8f2a4c1:/home/new.java  /home</span><br><br>[root@server1 ssh]# docker attach 2973e8f2a4c1<br>[root@2973e8f2a4c1 /]# cd /home/<br>[root@2973e8f2a4c1 home]# ls<br>lqs.java<br>[root@2973e8f2a4c1 home]# touch new.java<br>[root@2973e8f2a4c1 home]# ls<br>lqs.java  new.java<br>[root@2973e8f2a4c1 home]# read escape sequence<br>[root@server1 ssh]# cd<br>[root@server1 ~]# cd /home/<br>[root@server1 home]# ls<br>admin  lqs.java<br>[root@server1 home]# docker cp 2973e8f2a4c1:/home/new.java /home<br>[root@server1 home]# ls<br>admin  lqs.java  new.java<br>[root@server1 home]#<br></code></pre></td></tr></table></figure>

<h3><span id="7-测试用例">7、测试用例</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">测试用例，用完自动删</span><br>[root@server1 ssh]# docker run -it --rm tomcat:9.0<br></code></pre></td></tr></table></figure>

<h3><span id="8-可视化">8、可视化</span></h3><ul>
<li>portainer</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d -p 8088:9000 \<br>--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer<br></code></pre></td></tr></table></figure>

<ul>
<li>rancher</li>
</ul>
<h2><span id="小结">小结</span></h2><p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201130200435173.png#crop=0&crop=0&crop=1&crop=1&id=UI25N&originHeight=874&originWidth=1262&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h2><span id="作业">作业</span></h2><ul>
<li>DockerHub：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com</a></li>
</ul>
<h3><span id="安装-nginx">安装 Nginx</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 home]# docker pull nginx<br>Using default tag: latest<br>latest: Pulling from library/nginx<br>852e50cd189d: Pull complete<br>571d7e852307: Pull complete<br>addb10abd9cb: Pull complete<br>d20aa7ccdb77: Pull complete<br>8b03f1e11359: Pull complete<br>Digest: sha256:6b1daa9462046581ac15be20277a7c75476283f969cb3a61c8725ec38d3b01c3<br>Status: Downloaded newer image for nginx:latest<br>docker.io/library/nginx:latest<br>[root@server1 home]# docker images<br>REPOSITORY   TAG       IMAGE ID       CREATED        SIZE<br>nginx        latest    bc9a0695f571   5 days ago     133MB<br>centos       latest    0d120b6ccaa8   3 months ago   215MB<br>[root@server1 home]# docker run -d --name nginx01 -p 3344:80 nginx<br>730596a510eb00386fc0c2de680f1379bbee497c70f676df1588d635e944c115<br>[root@server1 home]# docker ps<br>CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS          PORTS                  NAMES<br>730596a510eb   nginx     &quot;/docker-entrypoint.…&quot;   4 seconds ago   Up 3 seconds    0.0.0.0:3344-&gt;80/tcp   nginx01<br>2973e8f2a4c1   centos    &quot;/bin/bash&quot;              5 hours ago     Up 25 minutes                          gallant_shirley<br><span class="hljs-meta prompt_"># </span><span class="language-bash">访问nginx</span><br>[root@server1 home]# curl localhost:3344<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;title&gt;Welcome to nginx!&lt;/title&gt;<br>&lt;style&gt;<br>    body &#123;<br>        width: 35em;<br>        margin: 0 auto;<br>        font-family: Tahoma, Verdana, Arial, sans-serif;<br>    &#125;<br>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;<br>&lt;p&gt;If you see this page, the nginx web server is successfully installed and<br>working. Further configuration is required.&lt;/p&gt;<br><br>&lt;p&gt;For online documentation and support please refer to<br>&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;<br>Commercial support is available at<br>&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;<br><br>&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br>[root@server1 home]#<br></code></pre></td></tr></table></figure>

<h3><span id="部署-elasticsearch-kibana">部署 ElasticSearch + Kibana</span></h3><ul>
<li>ES 端口暴露多</li>
<li>十分耗内存</li>
<li>ES 数据一般放置在安全目录</li>
<li>–net somenetwork 网络配置</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 home]# docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.9.3<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ES占用内存太大，修改JVM参数</span><br>[root@server1 home]# docker run -d --name elasticsearch01 -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:7.9.3<br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201201122158744.png#crop=0&crop=0&crop=1&crop=1&id=ptgKm&originHeight=574&originWidth=1258&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h1><span id="docker-镜像">Docker 镜像</span></h1><h2><span id="镜像">镜像</span></h2><blockquote>
<p>是一种轻量级、可执行的独立软件包。用来打包软件运行环境和基于运行环境开发的软件，包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。所有应用，直接打包 docker 镜像，就可以直接运行</p>
</blockquote>
<h2><span id="docker-镜像加载原理">Docker 镜像加载原理</span></h2><blockquote>
<p>UnionFS 文件系统</p>
</blockquote>
<p>UnionFS(联合文件系统): Union 文件系统(UnionFS)是一种分层、轻量级并且高性能的文件系统，它支持<strong>对文件系统的修改作为一次提交来一层层的叠加</strong>，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承, 基于基础镜像(没有父镜像)， 可以制作各种具体的应用镜像。<br>特性: 一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录。</p>
<blockquote>
<p>Docker 镜像加载原理</p>
</blockquote>
<p><strong>bootfs(boot file system)<strong>主要包含 bootloader 和 kernel，bootloader 主要是引导加载 kernel，Linux 刚启动时会加载 bootfs 文件系统，</strong>在 Docker 镜像的最底层是 bootfs</strong>。这一层与我们典型的 Linux&#x2F;Unix 系统是一样的, 包含 boot 加载器和内核。当 boot 加载完成之后整个内核就都在内存中了，此时内存的使用权已由 bootfs 转交给内核，此时系统也会卸载 bootfs。</p>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bqc2RzZw==,size_16,color_FFFFFF,t_70.png#crop=0&crop=0&crop=1&crop=1&id=RonQg&originHeight=230&originWidth=309&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<p><strong>rootfs(root file system)</strong>, 在 bootfs 之上。包含的就是典型 Linux 系统中的&#x2F;dev, &#x2F;proc, &#x2F;bin, &#x2F;etc 等标准目录和文件。rootfs 就是各种不同的操作系统发行版，比如 Ubuntu，Centos 等等。</p>
<p>对于一个精简的 OS，rootfs 可以很小，只需要包括最基本的命令、工具和程序库就可以了，因为底层直接用 Host 的 kernel，自己只需要提供 rootfs 就行了。由此可见对于不同的 linux 发行版，bootfs 基本是一致的，rootfs 会有差别，因此不同的发行版可以共用 bootfs。</p>
<blockquote>
<p>分层的镜像</p>
</blockquote>
<p>以我们的 pull 为例，在下载的过程中我们可以看到 docker 的镜像好像是在一层一层的在下载</p>
<blockquote>
<p>分层好处</p>
</blockquote>
<p><strong>共享资源</strong><br>比如：有多个镜像都从相同的 base 镜像构建而来，那么宿主机只需在磁盘上保存一份 base 镜像,同时内存中也只需加载一份 base 镜像，就可以为所有容器服务了。而且镜像的每一层都可以被共享。</p>
<blockquote>
<p>Docker 镜像特点</p>
</blockquote>
<p>Docker 镜像都是只读的<br>当容器启动时，一个新的可写层被加载到镜像的顶部。<br>这一层通常被称作为”容器层”，“容器层”之下的都叫”镜像层”。</p>
<h2><span id="commit-镜像">Commit 镜像</span></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker commit 类似于git<br><span class="hljs-meta prompt_"># </span><span class="language-bash">提交容器成为一个新的镜像</span><br><br>docker commit -m=&quot;描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名:[tag]<br></code></pre></td></tr></table></figure>

<h1><span id="docker-数据卷">Docker 数据卷</span></h1><blockquote>
<p>容器数据卷：能将数据可持久化，删除容器时可不删除存放的数据</p>
</blockquote>
<h2><span id="方式一-v-挂载">方式一：-v 挂载</span></h2><h3><span id="基本概念">基本概念</span></h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># 将新建的 centos 容器的/home 目录挂载在主机上/home/ceshi 文件夹进行<span class="hljs-strong">**双向绑定**</span></span><br><br>docker run -it -v /home/ceshi:/home centos /bin/bash<br><br><span class="hljs-section"># 在主机上使用 docker inspect id 查看数据卷挂载</span><br><br>&quot;Mounts&quot;: [<br>&#123;<br>&quot;Type&quot;: &quot;bind&quot;,<br>&quot;Source&quot;: &quot;/home/ceshi&quot;,<br>&quot;Destination&quot;: &quot;/home&quot;,<br>&quot;Mode&quot;: &quot;&quot;,<br>&quot;RW&quot;: true,<br>&quot;Propagation&quot;: &quot;rprivate&quot;<br>&#125;<br>],<br></code></pre></td></tr></table></figure>

<h3><span id="实战持久化-mysql">实战：持久化 MySQL</span></h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># 进行配置</span><br><br>[root@server1 home]# docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL<span class="hljs-emphasis">_ROOT_</span>PASSWORD=123456 --name mysql01 mysql:5.7<br>-d 后台运行<br>-p 端口<br>-v 数据卷挂载<br>-e 环境<br>--name 名字<br><br><span class="hljs-section"># 远程登录</span><br><br>🐂🍺 mysql -haly -P3310 -uroot -p<br><br><span class="hljs-section"># 此时删除容器，主机上的目录依然存在</span><br></code></pre></td></tr></table></figure>

<h3><span id="具名x2f匿名挂载">具名&#x2F;匿名挂载</span></h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># 匿名挂载</span><br><br><span class="hljs-section"># -v 容器内路径</span><br><br>docker run -d -P --name nginx01 -v /etc/nginx nginx<br><br><span class="hljs-section"># 具名挂载</span><br><br><span class="hljs-section"># -v 卷名:容器内路径</span><br><br><span class="hljs-section"># 默认挂载地址：/var/lib/docker/volumes/juming/\<span class="hljs-emphasis">_data</span></span><br><span class="hljs-emphasis"><span class="hljs-section"></span></span><br><span class="hljs-emphasis"><span class="hljs-section">[root@server1 data]# docker run -d -P --name nginx01 -v juming:/etc/nginx nginx</span></span><br><span class="hljs-emphasis"><span class="hljs-section">Unable to find image &#x27;nginx:latest&#x27; locally</span></span><br><span class="hljs-emphasis"><span class="hljs-section">latest: Pulling from library/nginx</span></span><br><span class="hljs-emphasis"><span class="hljs-section">852e50cd189d: Already exists</span></span><br><span class="hljs-emphasis"><span class="hljs-section">571d7e852307: Pull complete</span></span><br><span class="hljs-emphasis"><span class="hljs-section">addb10abd9cb: Pull complete</span></span><br><span class="hljs-emphasis"><span class="hljs-section">d20aa7ccdb77: Pull complete</span></span><br><span class="hljs-emphasis"><span class="hljs-section">8b03f1e11359: Pull complete</span></span><br><span class="hljs-emphasis"><span class="hljs-section">Digest: sha256:6b1daa9462046581ac15be20277a7c75476283f969cb3a61c8725ec38d3b01c3</span></span><br><span class="hljs-emphasis"><span class="hljs-section">Status: Downloaded newer image for nginx:latest</span></span><br><span class="hljs-emphasis"><span class="hljs-section">f4b4012c0245d5c7c32010b6cefdf14ab82ccd4eb7441201b13f38429022e121</span></span><br><span class="hljs-emphasis"><span class="hljs-section"></span></span><br><span class="hljs-emphasis"><span class="hljs-section"># 查看所有卷：docker volume ls</span></span><br><span class="hljs-emphasis"><span class="hljs-section"></span></span><br><span class="hljs-emphasis"><span class="hljs-section">[root@server1 data]# docker volume ls</span></span><br><span class="hljs-emphasis"><span class="hljs-section">DRIVER VOLUME NAME</span></span><br><span class="hljs-emphasis"><span class="hljs-section">local 9a7e9a5a0533594193bd5711b1f52899f22f5ed9d7c09a18356455a8a270fbcd</span></span><br><span class="hljs-emphasis"><span class="hljs-section">local juming</span></span><br><span class="hljs-emphasis"><span class="hljs-section"></span></span><br><span class="hljs-emphasis"><span class="hljs-section"># 查看卷名元数据：docker volume inspect juming</span></span><br><span class="hljs-emphasis"><span class="hljs-section"></span></span><br><span class="hljs-emphasis"><span class="hljs-section">[root@server1 data]# docker volume inspect juming</span></span><br><span class="hljs-emphasis"><span class="hljs-section">[</span></span><br><span class="hljs-emphasis"><span class="hljs-section">&#123;</span></span><br><span class="hljs-emphasis"><span class="hljs-section">&quot;CreatedAt&quot;: &quot;2020-12-01T15:43:14+08:00&quot;,</span></span><br><span class="hljs-emphasis"><span class="hljs-section">&quot;Driver&quot;: &quot;local&quot;,</span></span><br><span class="hljs-emphasis"><span class="hljs-section">&quot;Labels&quot;: null,</span></span><br><span class="hljs-emphasis"><span class="hljs-section"># 本地存储位置</span></span><br><span class="hljs-emphasis"><span class="hljs-section">&quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/juming/_</span>data&quot;,</span><br>&quot;Name&quot;: &quot;juming&quot;,<br>&quot;Options&quot;: null,<br>&quot;Scope&quot;: &quot;local&quot;<br>&#125;<br>]<br></code></pre></td></tr></table></figure>

<ul>
<li>拓展</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># 通过-v 指定容器内路径及读写权限</span><br><br><span class="hljs-section"># ro: 只读,只能通过宿主机改变，容器内部不能修改</span><br><br><span class="hljs-section"># rw:可读可写(default)</span><br><br>-v 卷名:路径:ro/rw<br></code></pre></td></tr></table></figure>

<h2><span id="初识-dockerfile">初识 DockerFile</span></h2><blockquote>
<p>实际就是 imageFile，构建 Docker 镜像的构建脚本</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 docker-test-volume]# vim dockerfile1<br><br>FROM centos<br><br>VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]<br><br>CMD echo &quot;===end===&quot;<br>CMD /bin/bash<br><br>[root@server1 docker-test-volume]# docker build -f dockerfile1 -t lqs/centos:1.0 .<br>Sending build context to Docker daemon  2.048kB<br>Step 1/4 : FROM centos<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">0d120b6ccaa8</span><br>Step 2/4 : VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> 139b85666b23</span><br>Removing intermediate container 139b85666b23<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">5ba70f0b2c01</span><br>Step 3/4 : CMD echo &quot;===end===&quot;<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> b7b3d3d10528</span><br>Removing intermediate container b7b3d3d10528<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">a2f5c60a54e0</span><br>Step 4/4 : CMD /bin/bash<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> b7a8f6f55f83</span><br>Removing intermediate container b7a8f6f55f83<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">1153bee64870</span><br>Successfully built 1153bee64870<br>Successfully tagged lqs/centos:1.0<br>[root@server1 docker-test-volume]# docker images<br>REPOSITORY   TAG       IMAGE ID       CREATED         SIZE<br>lqs/centos   1.0       1153bee64870   9 seconds ago   215MB<br>nginx        latest    bc9a0695f571   6 days ago      133MB<br>mysql        5.7       ae0658fdbad5   10 days ago     449MB<br>centos       latest    0d120b6ccaa8   3 months ago    215MB<br></code></pre></td></tr></table></figure>

<ul>
<li>可以看到生存镜像是自动给挂载的数据卷</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 docker-test-volume]# docker run -it 1153bee64870 /bin/bash<br>[root@1e6c5ff18e75 /]# ls -l<br>total 0<br>lrwxrwxrwx   1 root root   7 May 11  2019 bin -&gt; usr/bin<br>drwxr-xr-x   5 root root 360 Dec  1 08:20 dev<br>drwxr-xr-x   1 root root  66 Dec  1 08:20 etc<br>drwxr-xr-x   2 root root   6 May 11  2019 home<br>lrwxrwxrwx   1 root root   7 May 11  2019 lib -&gt; usr/lib<br>lrwxrwxrwx   1 root root   9 May 11  2019 lib64 -&gt; usr/lib64<br>drwx------   2 root root   6 Aug  9 21:40 lost+found<br>drwxr-xr-x   2 root root   6 May 11  2019 media<br>drwxr-xr-x   2 root root   6 May 11  2019 mnt<br>drwxr-xr-x   2 root root   6 May 11  2019 opt<br>dr-xr-xr-x 118 root root   0 Dec  1 08:20 proc<br>dr-xr-x---   2 root root 162 Aug  9 21:40 root<br>drwxr-xr-x  11 root root 163 Aug  9 21:40 run<br>lrwxrwxrwx   1 root root   8 May 11  2019 sbin -&gt; usr/sbin<br>drwxr-xr-x   2 root root   6 May 11  2019 srv<br>dr-xr-xr-x  13 root root   0 Dec  1 08:20 sys<br>drwxrwxrwt   7 root root 145 Aug  9 21:40 tmp<br>drwxr-xr-x  12 root root 144 Aug  9 21:40 usr<br>drwxr-xr-x  20 root root 262 Aug  9 21:40 var<br>drwxr-xr-x   2 root root   6 Dec  1 08:20 volume01<br>drwxr-xr-x   2 root root   6 Dec  1 08:20 volume02<br></code></pre></td></tr></table></figure>

<h2><span id="数据卷容器">数据卷容器</span></h2><ul>
<li>实现多容器数据共享</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">这样docker02和docker03的文件随docker01文件的改变而改变</span><br>[root@server1 /]# docker run -it --name docker02 --volumes-from docker01  lqs/centos:1.0<br>[root@server1 /]# docker run -it --name docker03 --volumes-from docker01  lqs/centos:1.0<br><br>- 但是删除docker01时docker02和docker03的文件依然存在，都存在宿主机文件中<br></code></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<p>容器之间配置信息的传递，一直持续到没有容器使用为止</p>
<p>一旦持久化到本地，本地数据不会删除</p>
</blockquote>
<h1><span id="dockerfile">DockerFile</span></h1><blockquote>
<p>构建 DockerImage 镜像的文件，是命令参数脚本，定义一切步骤和源代码</p>
<p>面向开发，逐渐成为企业交付的标准。</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> 注意:<br><br><span class="hljs-section"># 每个关键字必须大写</span><br><br><span class="hljs-section"># 执行从上到下按序执行</span><br><br><span class="hljs-bullet">-</span> 1、编写一个 dockerfile 文件<br><span class="hljs-bullet">-</span> 2、docker build 构建镜像<br><span class="hljs-bullet">-</span> 3、docker run 运行镜像<br><span class="hljs-bullet">-</span> 4、docker push 发布镜像到 DockerHub or 阿里云镜像仓库<br><br><span class="hljs-section"># #表示注释</span><br><br><span class="hljs-section"># 每个指令都表示一个新的镜像层，并提交</span><br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201201213837893.png#crop=0&crop=0&crop=1&crop=1&id=RZYCO&originHeight=622&originWidth=862&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h2><span id="dockerfile-命令">DockerFile 命令</span></h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> FROM 基础镜像，一起从这里开始<br><span class="hljs-bullet">-</span> MAINTAINER 作者，姓名+邮箱<br><span class="hljs-bullet">-</span> RUN 镜像构建的时候需要运行的命令<br><span class="hljs-bullet">-</span> ADD tomcat 镜像<br><span class="hljs-bullet">-</span> WORKDIR 镜像工作目录<br><span class="hljs-bullet">-</span> VOLUME 挂载目录<br><span class="hljs-bullet">-</span> EXPOSE 保留端口配置<br><span class="hljs-bullet">-</span> CMD 指定容器启动时运行的指令,只有最后一个会生效，可被替代<br><span class="hljs-bullet">-</span> ENTRYPOINT 指定容器启动时运行的指令，可以追加命令<br><span class="hljs-bullet">-</span> ONBUILD 触发指令：当构建一个被挤成 DockerFile，这个时候就运行<br><span class="hljs-bullet">-</span> COPY 类似 ADD，将文件拷贝到镜像中<br><span class="hljs-bullet">-</span> ENV 环境变量<br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/be92f97487fe2d254f4fd40da4985239.jpg#crop=0&crop=0&crop=1&crop=1&id=QRHKh&originHeight=407&originWidth=724&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h2><span id="例子构建个人-centos">例子：构建个人 centos</span></h2><h3><span id="编写配置文件">编写配置文件</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 docker-test-volume]# vim dockerfile-centos<br>FROM centos<br>MAINTAINER lqs&lt;polarisink@163.com&gt;<br><br>ENV MYPATH /usr/local<br>WORKDIR $MYPATH<br><br>RUN yum -y install vim<br>RUN yum -y install net-tools<br><br>EXPOSE 80<br><br>CMD echo $MYPATH<br>CMD echo &quot;-----end----&quot;<br>CMD /bin/bash<br></code></pre></td></tr></table></figure>

<h3><span id="通过文件构建镜像不能少">通过文件构建镜像（.不能少）</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 docker-test-volume]# docker build -f dockerfile-centos -t mycentos:0.1 .<br>Successfully built 69a888bf8bdb<br>Successfully tagged mycentos:0.1<br></code></pre></td></tr></table></figure>

<h3><span id="测试运行vim-和-ifconfig-可以使用">测试运行（vim 和 ifconfig 可以使用）</span></h3><p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201202130933453.png#crop=0&crop=0&crop=1&crop=1&id=CTEsg&originHeight=1254&originWidth=1300&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h3><span id="查看历史">查看历史</span></h3><p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201202131332942.png#crop=0&crop=0&crop=1&crop=1&id=vVzwM&originHeight=694&originWidth=1522&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h3><span id="cmd-ampamp-entrypoint">CMD &amp;&amp; ENTRYPOINT</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">CMD						指定容器启动时运行的指令,只有最后一个会生效，可被替代</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ENTRYPOINT		指定容器启动时运行的指令，可以追加命令</span><br><br>[root@server1 docker-test-volume]# cat dockerfile-cmd-test<br>FROM centos<br><br>CMD [&quot;ls&quot;, &quot;-a&quot;]<br><br>[root@server1 docker-test-volume]# cat dockerfile-entrypoint-test<br>FROM centos<br><br>ENTRYPOINT [&quot;ls&quot;, &quot;-a&quot;]<br><span class="hljs-meta prompt_"># </span><span class="language-bash">不能追加命令</span><br>[root@server1 docker-test-volume]# docker run cmdtest -l<br>docker: Error response from daemon: OCI runtime create failed: container_linux.go:370: starting container process caused: exec: &quot;-l&quot;: executable file not found in $PATH: unknown.<br><span class="hljs-meta prompt_"># </span><span class="language-bash">可以追加命令</span><br>[root@server1 docker-test-volume]# docker run mycentos-entrypoint -l<br>total 0<br>drwxr-xr-x   1 root root   6 Dec  2 05:32 .<br>drwxr-xr-x   1 root root   6 Dec  2 05:32 ..<br>-rwxr-xr-x   1 root root   0 Dec  2 05:32 .dockerenv<br>lrwxrwxrwx   1 root root   7 May 11  2019 bin -&gt; usr/bin<br>drwxr-xr-x   5 root root 340 Dec  2 05:32 dev<br>drwxr-xr-x   1 root root  66 Dec  2 05:32 etc<br>drwxr-xr-x   2 root root   6 May 11  2019 home<br>lrwxrwxrwx   1 root root   7 May 11  2019 lib -&gt; usr/lib<br>lrwxrwxrwx   1 root root   9 May 11  2019 lib64 -&gt; usr/lib64<br>drwx------   2 root root   6 Aug  9 21:40 lost+found<br>drwxr-xr-x   2 root root   6 May 11  2019 media<br>drwxr-xr-x   2 root root   6 May 11  2019 mnt<br>drwxr-xr-x   2 root root   6 May 11  2019 opt<br>dr-xr-xr-x 125 root root   0 Dec  2 05:32 proc<br>dr-xr-x---   2 root root 162 Aug  9 21:40 root<br>drwxr-xr-x  11 root root 163 Aug  9 21:40 run<br>lrwxrwxrwx   1 root root   8 May 11  2019 sbin -&gt; usr/sbin<br>drwxr-xr-x   2 root root   6 May 11  2019 srv<br>dr-xr-xr-x  13 root root   0 Dec  2 05:32 sys<br>drwxrwxrwt   7 root root 145 Aug  9 21:40 tmp<br>drwxr-xr-x  12 root root 144 Aug  9 21:40 usr<br>drwxr-xr-x  20 root root 262 Aug  9 21:40 var<br>[root@server1 docker-test-volume]#<br></code></pre></td></tr></table></figure>

<h2><span id="实战构建-tomcat-镜像">实战：构建 Tomcat 镜像</span></h2><h3><span id="1-准备镜像文件">1、准备镜像文件</span></h3><ul>
<li>tomcat 压缩包，jdk 压缩包，readme.txt</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 tomcat]# ls<br>apache-tomcat-8.5.54.tar.gz  jdk-8u271-linux-x64.tar.gz  readme.txt<br></code></pre></td></tr></table></figure>

<h3><span id="2-编写dockerfile">2、编写<code>Dockerfile</code></span></h3><ul>
<li>官方推荐名字，可以自动寻找</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 tomcat]# vim Dockerfile<br><br><br>FROM    centos<br>MAINTAINER polarisink&lt;polarisink@163.com&gt;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">复制文件</span><br>COPY readme.txt /usr/local/readme.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">增加，会自动解压</span><br>ADD jdk-8u271-linux-x64.tar.gz   /usr/local<br>ADD apache-tomcat-8.5.54.tar.gz  /usr/local<br><br>RUN yum -y install vim<br><br>ENV MYPATH /usr/local<br>WORKDIR $MYPATH<br><span class="hljs-meta prompt_"># </span><span class="language-bash">配置环境变量</span><br>ENV JAVA_HOME /usr/local/jdk1.8.0_271<br>ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br>ENV CATALINA_HOME /usr/local/apache-tomcat-8.5.54<br>ENV CATALINA_BASH /usr/local/apache-tomcat-8.5.54<br>ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin<br><br>EXPOSE 8080<br><br>CMD /usr/local/apache-tomcat-8.5.54/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-8.5.54/bin/logs/catalina.out<br></code></pre></td></tr></table></figure>

<h3><span id="3-build-镜像">3、build 镜像</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 tomcat]# docker build -t diytomcat .<br>Sending build context to Docker daemon  153.5MB<br>Step 1/15 : FROM	centos<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">0d120b6ccaa8</span><br>Step 2/15 : MAINTAINER polarisink&lt;polarisink@163.com&gt;<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> 38b244f6ae39</span><br>Removing intermediate container 38b244f6ae39<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">7df638db0336</span><br>Step 3/15 : COPY readme.txt /usr/local/readme.txt<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">4d8f3f2150ab</span><br>Step 4/15 : ADD jdk-8u271-linux-x64.tar.gz	 /usr/local<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">9e75aa75f839</span><br>Step 5/15 : ADD apache-tomcat-8.5.54.tar.gz  /usr/local<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">613500475b41</span><br>Step 6/15 : RUN yum -y install vim<br></code></pre></td></tr></table></figure>

<p>Step 15&#x2F;15 : CMD &#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.54&#x2F;bin&#x2F;startup.sh &amp;&amp; tail -F &#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.54&#x2F;bin&#x2F;logs&#x2F;catalina.out<br>—&gt; Running in 1a5e363f4779<br>Removing intermediate container 1a5e363f4779<br>—&gt; 311502a899e6<br>Successfully built 311502a899e6<br>Successfully tagged diytomcat:latest</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><br>### <span class="hljs-number">4</span>、启动镜像<br><br>```shell<br># 挂载两个目录<br>[root@server1 tomcat]# docker run -d -p <span class="hljs-number">9090</span>:<span class="hljs-number">8080</span> --name polaristomcat -v <span class="hljs-regexp">/home/</span>ceshi<span class="hljs-regexp">/tomcat/</span>test:<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/apache-tomcat-8.5.54/</span>webapps<span class="hljs-regexp">/test -v /</span>home<span class="hljs-regexp">/ceshi/</span>tomcat<span class="hljs-regexp">/tomcatlogs/</span>:<span class="hljs-regexp">/uar/</span>local<span class="hljs-regexp">/apache-tomcat-8.5.54/</span>logs diytomcat<br><span class="hljs-number">7</span>b4e433ae6c695d8290b58e8ea517cca12232bdc89a1f4dd2df695ec4ce6a18c<br></code></pre></td></tr></table></figure>

<h3><span id="5-访问测试">5、访问测试</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 tomcat]# curl localhost:9090<br><br><br><br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>    &lt;head&gt;<br>        &lt;meta charset=&quot;UTF-8&quot; /&gt;<br>        &lt;title&gt;Apache Tomcat/8.5.54&lt;/title&gt;<br>        &lt;link href=&quot;favicon.ico&quot; rel=&quot;icon&quot; type=&quot;image/x-icon&quot; /&gt;<br>        &lt;link href=&quot;favicon.ico&quot; rel=&quot;shortcut icon&quot; type=&quot;image/x-icon&quot; /&gt;<br>        &lt;link href=&quot;tomcat.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;<br>    &lt;/head&gt;<br></code></pre></td></tr></table></figure>

<h3><span id="6-发布项目">6、发布项目</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# cd /home/ceshi/tomcat/test/<br>[root@server1 test]# ls<br>index.jsp  WEB-INFO<br>[root@server1 test]# docker run -d -p 9090:8080 --name polaristomcat2 -v /home/ceshi/tomcat/test:/usr/local/apache-tomcat-8.5.54/webapps/test -v /home/ceshi/tomcat/tomcatlogs:/usr/local/apache-tomcat-8.5.54/logs diytomcat<br>[root@server1 ~]# cat /home/ceshi/tomcat/tomcatlogs/catalina.out<br>02-Dec-2020 07:09:02.863 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/apache-tomcat-8.5.54/webapps/test] has finished in [60] ms<br>02-Dec-2020 07:09:02.879 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [&quot;http-nio-8080&quot;]<br>02-Dec-2020 07:09:02.925 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 1618 ms<br>--my test web logs---<br>--my test web logs---<br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com/uPic/image-20201202145821191.png#crop=0&crop=0&crop=1&crop=1&id=klhRw&originHeight=344&originWidth=778&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h2><span id="发布个人镜像">发布个人镜像</span></h2><ol>
<li>登录<a target="_blank" rel="noopener" href="https://hub.docker.com/">DockerHub</a></li>
<li>在服务器上登录 dockerhub</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 tomcatlogs]# docker login -u polarisink<br>Password:<br>WARNING! Your password will be stored unencrypted in /root/.docker/config.json.<br>Configure a credential helper to remove this warning. See<br>https://docs.docker.com/engine/reference/commandline/login/#credentials-store<br><br>Login Succeeded<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>提交镜像到 dockerhub</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 tomcatlogs]# docker images<br>REPOSITORY            TAG       IMAGE ID       CREATED             SIZE<br>diytomcat             latest    311502a899e6   About an hour ago   642MB<br>mycentos-entrypoint   latest    72d222203c8b   2 hours ago         215MB<br>cmdtest               latest    09422ecb6cde   2 hours ago         215MB<br>mycentos              0.1       69a888bf8bdb   3 hours ago         295MB<br>lqs/centos            1.0       1153bee64870   23 hours ago        215MB<br>nginx                 latest    bc9a0695f571   7 days ago          133MB<br>mysql                 5.7       ae0658fdbad5   11 days ago         449MB<br>centos                latest    0d120b6ccaa8   3 months ago        215MB<br><span class="hljs-meta prompt_"># </span><span class="language-bash">push可以使用tag重命名</span><br>[root@server1 tomcatlogs]# docker tag 311502a899e6 polarisink/tomcat:1.0<br>[root@server1 tomcatlogs]# docker push polarisink/tomcat:1.0<br>The push refers to repository [docker.io/polarisink/tomcat]<br>96030ed24189: Pushing  11.35MB/57.24MB<br>d6314d23ddb4: Pushing  2.111MB/14.45MB<br>0d60766e4c76: Pushing  3.857MB/355.3MB<br>264590514375: Pushed<br>291f6e44771a: Pushing  6.561MB/215.1MB<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>提交到阿里云镜像仓库</li>
</ol>
<ul>
<li>注册命名空间和仓库</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204192104227.png#crop=0&crop=0&crop=1&crop=1&id=zXqBf&originHeight=214&originWidth=2042&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>基本信息</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">登陆阿里云容器镜像服务</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo docker login --username=lxl520lqs registry.cn-hangzhou.aliyuncs.com</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">pull镜像</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo docker pull registry.cn-hangzhou.aliyuncs.com/polarsink/kuangshendocker:[镜像版本号]</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">给镜像起名</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/polarsink/kuangshendocker:[镜像版本号]</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">push镜像</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo docker push registry.cn-hangzhou.aliyuncs.com/polarsink/kuangshendocker:[镜像版本号]</span><br></code></pre></td></tr></table></figure>

<h1><span id="docker-网络">Docker 网络</span></h1><h2><span id="docker0">Docker0</span></h2><h3><span id="1-准备和观察">1、准备和观察</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">先环境清零</span><br>docker rm -f $(docker ps -aq)<br>docker rmi $(docker images -q)<br>docker volume rm $(docker volume ls -q)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看网卡</span><br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204203129431.png#crop=0&crop=0&crop=1&crop=1&id=GTRyv&originHeight=810&originWidth=1832&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>查看容器内部网络</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204205802117.png#crop=0&crop=0&crop=1&crop=1&id=P92DG&originHeight=474&originWidth=1922&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>Linux 主机可以 ping 通容器内部</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204205857887.png#crop=0&crop=0&crop=1&crop=1&id=pnkXj&originHeight=558&originWidth=1922&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> 安装 Docker 时，系统给 Docker 分配一个 docker0 网卡<br><span class="hljs-bullet">-</span> 每当启动一个 Docker 容器，Docker 就会给 Docker 容器分配一个 ip<br>  5: vethf6beca6@if4: <span class="language-xml">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu 1500 qdisc noqueue master docker0 state UP group default<br>  link/ether 36:bf:79:d7:66:46 brd ff:ff:ff:ff:ff:ff link-netnsid 0<br>  inet6 fe80::34bf:79ff:fed7:6646/64 scope link<br>  valid<span class="hljs-emphasis">_lft forever preferred_</span>lft forever<br><span class="hljs-bullet">-</span> 使用桥接模式，采用 evth-pair 技术<br></code></pre></td></tr></table></figure>

<p>![image-20201204205621273](&#x2F;Users&#x2F;lqs&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20201204205621273.png)</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># evth-pair</span><br><br><span class="hljs-bullet">-</span> 一对对的虚拟设备接口，成对出现<br><span class="hljs-bullet">-</span> 一段连着协议，一段连接彼此<br><span class="hljs-bullet">-</span> 用来充当桥梁，连接各种虚拟网络设备<br><br><span class="hljs-section"># 结论</span><br><br><span class="hljs-bullet">-</span> 所有容器在不指定网络的情况下，都使用 docker 作为路由器<br><span class="hljs-bullet">-</span> docker0 为容器 A 和容器 B 分配一个默认可用的 IP<br><span class="hljs-bullet">-</span> 当删除容器时虚拟网卡会删除<br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201204212214535.png#crop=0&crop=0&crop=1&crop=1&id=H5faj&originHeight=760&originWidth=1014&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h2><span id="link">–Link</span></h2><blockquote>
<p>作用：端口绑定，将 link 写入&#x2F;etc&#x2F;hosts</p>
<p>现在一般放弃使用，因为默认使用 docker0 网卡，不能自定义</p>
<p>docker0 不支持容器名连接访问</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs markdown">[root@server1 blog]# docker run -d -P --name tomcat04 --link tomcat03 tomcat<br>b46b2485ff5c82cf7ca7ad394f30cbb1cc80dfcc407980105ef08a6a3c033c5f<br>[root@server1 blog]# docker exec -it tomcat04 cat /etc/hosts<br>127.0.0.1 localhost<br>::1 localhost ip6-localhost ip6-loopback<br>fe00::0 ip6-localnet<br>ff00::0 ip6-mcastprefix<br>ff02::1 ip6-allnodes<br>ff02::2 ip6-allrouters<br><br><span class="hljs-section"># 可以发现 tomcat03 的 ip 被写入 hosts 文件中</span><br><br>172.18.0.4 tomcat03 0f3204836c34<br>172.18.0.5 b46b2485ff5c<br>[root@server1 blog]#<br></code></pre></td></tr></table></figure>

<h2><span id="自定义网络">自定义网络</span></h2><h3><span id="网络模式">网络模式</span></h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># bridge:桥接网络(默认，自定义也使用此方式)</span><br><br><span class="hljs-section"># none:不配置网络</span><br><br><span class="hljs-section"># host:和宿主机共享网络</span><br><br><span class="hljs-section"># container:容器网络连接(用得少，局限性大)</span><br></code></pre></td></tr></table></figure>

<h3><span id="自定义网络">自定义网络</span></h3><blockquote>
<p>docker network create</p>
<p>好处：不同集群使用不同的网络，保证集群的安全和健康</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet<br>68db8c5bfd01e7237a19d9cc2aaec9e0199c2690de3926065a16d89224de3250<br>[root@server1 ~]# docker network ls<br>NETWORK ID          NAME                DRIVER              SCOPE<br>e2e8121885a1        blog_default        bridge              local<br>e7745415748f        bridge              bridge              local<br>998422bb93bb        host                host                local<br>68db8c5bfd01        mynet               bridge              local<br>3a5d3fb4c291        none                null                local<br>[root@server1 ~]# docker network inspect mynet<br>[<br>    &#123;<br>        &quot;Name&quot;: &quot;mynet&quot;,<br>        &quot;Id&quot;: &quot;68db8c5bfd01e7237a19d9cc2aaec9e0199c2690de3926065a16d89224de3250&quot;,<br>        &quot;Created&quot;: &quot;2020-12-05T11:14:01.64643517+08:00&quot;,<br>        &quot;Scope&quot;: &quot;local&quot;,<br>        &quot;Driver&quot;: &quot;bridge&quot;,<br>        &quot;EnableIPv6&quot;: false,<br>        &quot;IPAM&quot;: &#123;<br>            &quot;Driver&quot;: &quot;default&quot;,<br>            &quot;Options&quot;: &#123;&#125;,<br>            &quot;Config&quot;: [<br>                &#123;<br>                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,<br>                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;<br>                &#125;<br>            ]<br>        &#125;,<br>        &quot;Internal&quot;: false,<br>        &quot;Attachable&quot;: false,<br>        &quot;Ingress&quot;: false,<br>        &quot;ConfigFrom&quot;: &#123;<br>            &quot;Network&quot;: &quot;&quot;<br>        &#125;,<br>        &quot;ConfigOnly&quot;: false,<br>        &quot;Containers&quot;: &#123;&#125;,<br>        &quot;Options&quot;: &#123;&#125;,<br>        &quot;Labels&quot;: &#123;&#125;<br>    &#125;<br>]<br></code></pre></td></tr></table></figure>

<h3><span id="测试">测试</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat<br>[root@server1 ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat<br>a65f9956dfa468e2f642c6d784172dac6beb81be0ca7170ca3c9417066b8ca0d<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">二者在同一子网，可以用名字互ping</span><br>[root@server1 ~]# docker exec -it tomcat-net-01 ping tomcat-net-02<br>PING tomcat-net-02 (192.168.0.3) 56(84) bytes of data.<br>64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.115 ms<br>64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.084 ms<br>64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.063 ms<br>^C<br>--- tomcat-net-02 ping statistics ---<br>3 packets transmitted, 3 received, 0% packet loss, time 39ms<br>rtt min/avg/max/mdev = 0.063/0.087/0.115/0.022 ms<br>[root@server1 ~]#<br></code></pre></td></tr></table></figure>

<ul>
<li>跨网络互 ping</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">此时tomcat-net-01和tomcat01不在同一网络，不能互ping</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">需要docker network connect进行连接</span><br>[root@server1 ~]# docker exec -it tomcat01 ping tomcat-net-01<br>ping: tomcat-net-01: Name or service not known<br></code></pre></td></tr></table></figure>

<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201205113928051.png#crop=0&crop=0&crop=1&crop=1&id=BqF9R&originHeight=722&originWidth=1176&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<h3><span id="部署-redis-集群">部署 Redis 集群</span></h3><ul>
<li>要求</li>
</ul>
<p><img src="https://lqsgoodboy.oss-cn-shanghai.aliyuncs.com//uPic/image-20201205115029255.png#crop=0&crop=0&crop=1&crop=1&id=lEBk9&originHeight=728&originWidth=1180&originalType=binary%E2%88%B6=1&rotation=0&showTitle=false&status=done&style=none&title=" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>编写 shell 脚本创建 Redis 容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">创建网卡</span><br>docker network create redis --subnet 172.38.0.0/16<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">脚本</span><br>for port in $(seq 1 6);\<br>do \<br>mkdir -p /mydata/redis/node-$&#123;port&#125;/conf<br>touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf<br>cat &lt;&lt; EOF &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf<br>port 6379<br>bind 0.0.0.0<br>cluster-enabled yes<br>cluster-config-file nodes.conf<br>cluster-node-timeout 5000<br>cluster-announce-ip 172.38.0.1$&#123;port&#125;<br>cluster-announce-port 6379<br>cluster-announce-bus-port 16379<br>appendonly yes<br>EOF<br>done<br><br>docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \<br>-v /mydata/redis/node-$&#123;port&#125;/data:/data \<br>-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 172.38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf; \<br><br>docker run -p 6376:6379 -p 16376:16379 --name redis-6 \<br>-v /mydata/redis/node-6/data:/data \<br>-v /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 172.38.0.16 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf; \<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建集群</span><br>/data # redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Performing <span class="hljs-built_in">hash</span> slots allocation on 6 nodes...</span><br>Master[0] -&gt; Slots 0 - 5460<br>Master[1] -&gt; Slots 5461 - 10922<br>Master[2] -&gt; Slots 10923 - 16383<br>Adding replica 172.38.0.15:6379 to 172.38.0.11:6379<br>Adding replica 172.38.0.16:6379 to 172.38.0.12:6379<br>Adding replica 172.38.0.14:6379 to 172.38.0.13:6379<br>M: 0f5cca1448266f1afb8a2818229e73f716ccf3e4 172.38.0.11:6379<br>   slots:[0-5460] (5461 slots) master<br>M: f86cd1e9ab3ef69d6c7da52dddc16091346f00d7 172.38.0.12:6379<br>   slots:[5461-10922] (5462 slots) master<br>M: 2ceb335c841c7313ce9a14f664ce5f32d8a79a84 172.38.0.13:6379<br>   slots:[10923-16383] (5461 slots) master<br>S: c30fdd6b0698566ed0fc043c267809a98353e5a0 172.38.0.14:6379<br>   replicates 2ceb335c841c7313ce9a14f664ce5f32d8a79a84<br>S: 20ea2a40faaa3212237677d3adefe3fe543fa838 172.38.0.15:6379<br>   replicates 0f5cca1448266f1afb8a2818229e73f716ccf3e4<br>S: 9d3e36fdff17d3b5f95e94024d2af63d8c19be32 172.38.0.16:6379<br>   replicates f86cd1e9ab3ef69d6c7da52dddc16091346f00d7<br>Can I set the above configuration? (type &#x27;yes&#x27; to accept): yes<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Nodes configuration updated</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Assign a different config epoch to each node</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Sending CLUSTER MEET messages to <span class="hljs-built_in">join</span> the cluster</span><br>Waiting for the cluster to join<br>..<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Performing Cluster Check (using node 172.38.0.11:6379)</span><br>M: 0f5cca1448266f1afb8a2818229e73f716ccf3e4 172.38.0.11:6379<br>   slots:[0-5460] (5461 slots) master<br>   1 additional replica(s)<br>M: f86cd1e9ab3ef69d6c7da52dddc16091346f00d7 172.38.0.12:6379<br>   slots:[5461-10922] (5462 slots) master<br>   1 additional replica(s)<br>M: 2ceb335c841c7313ce9a14f664ce5f32d8a79a84 172.38.0.13:6379<br>   slots:[10923-16383] (5461 slots) master<br>   1 additional replica(s)<br>S: 20ea2a40faaa3212237677d3adefe3fe543fa838 172.38.0.15:6379<br>   slots: (0 slots) slave<br>   replicates 0f5cca1448266f1afb8a2818229e73f716ccf3e4<br>S: 9d3e36fdff17d3b5f95e94024d2af63d8c19be32 172.38.0.16:6379<br>   slots: (0 slots) slave<br>   replicates f86cd1e9ab3ef69d6c7da52dddc16091346f00d7<br>S: c30fdd6b0698566ed0fc043c267809a98353e5a0 172.38.0.14:6379<br>   slots: (0 slots) slave<br>   replicates 2ceb335c841c7313ce9a14f664ce5f32d8a79a84<br>[OK] All nodes agree about slots configuration.<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Check <span class="hljs-keyword">for</span> open slots...</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Check slots coverage...</span><br>[OK] All 16384 slots covered.<br>/data #<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">搭建成功</span><br>172.38.0.14:6379&gt; cluster nodes<br>f86cd1e9ab3ef69d6c7da52dddc16091346f00d7 172.38.0.12:6379@16379 master - 0 1607142666417 2 connected 5461-10922<br>9d3e36fdff17d3b5f95e94024d2af63d8c19be32 172.38.0.16:6379@16379 slave f86cd1e9ab3ef69d6c7da52dddc16091346f00d7 0 1607142667421 6 connected<br>2ceb335c841c7313ce9a14f664ce5f32d8a79a84 172.38.0.13:6379@16379 slave c30fdd6b0698566ed0fc043c267809a98353e5a0 0 1607142667019 7 connected<br>20ea2a40faaa3212237677d3adefe3fe543fa838 172.38.0.15:6379@16379 slave 0f5cca1448266f1afb8a2818229e73f716ccf3e4 0 1607142666000 5 connected<br>c30fdd6b0698566ed0fc043c267809a98353e5a0 172.38.0.14:6379@16379 myself,master - 0 1607142666000 7 connected 10923-16383<br>0f5cca1448266f1afb8a2818229e73f716ccf3e4 172.38.0.11:6379@16379 master - 0 1607142666518 1 connected 0-5460<br>172.38.0.14:6379&gt;<br></code></pre></td></tr></table></figure>

<h2><span id="springboot-微服务打包-docker-镜像">SpringBoot 微服务打包 Docker 镜像</span></h2><ol>
<li>编写 SpringBoot 代码</li>
<li>打包应用</li>
<li>编写 Dockerfile</li>
<li>发布镜像到服务器</li>
<li>发布运行</li>
</ol>
<h1><span id="docker-compose">Docker Compose</span></h1><blockquote>
<p>轻松高效地管理容器，定义运行多个容器</p>
<p>让程序在任何地方运行：web 服务、redis、mysql、nginx</p>
<p>本节文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/gettingstarted/">https://docs.docker.com/compose/gettingstarted/</a></p>
</blockquote>
<h2><span id="三步骤">三步骤</span></h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> 1、定义 Dockerfile<br><span class="hljs-bullet">-</span> 2、编写 docker-compose.yml<br><span class="hljs-bullet">  -</span> services：容器，应用（web、redis、mysql）<br><span class="hljs-bullet">  -</span> project：项目，一组关联的容器<br><span class="hljs-bullet">-</span> 3、通过命令 docker-compose up 启动<br></code></pre></td></tr></table></figure>

<h2><span id="例子">例子</span></h2><ol>
<li>编写应用 app.py</li>
</ol>
<ul>
<li>Create a directory for the project:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> composetest</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> composetest</span><br></code></pre></td></tr></table></figure>

<ul>
<li>编写应用 <code>app.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">import</span> redis<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><br>app = Flask(__name__)<br>cache = redis.Redis(host=<span class="hljs-string">&#x27;redis&#x27;</span>, port=<span class="hljs-number">6379</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_hit_count</span>():<br>    retries = <span class="hljs-number">5</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">return</span> cache.incr(<span class="hljs-string">&#x27;hits&#x27;</span>)<br>        <span class="hljs-keyword">except</span> redis.exceptions.ConnectionError <span class="hljs-keyword">as</span> exc:<br>            <span class="hljs-keyword">if</span> retries == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">raise</span> exc<br>            retries -= <span class="hljs-number">1</span><br>            time.sleep(<span class="hljs-number">0.5</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():<br>    count = get_hit_count()<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello World! I have been seen &#123;&#125; times.\n&#x27;</span>.<span class="hljs-built_in">format</span>(count)<br></code></pre></td></tr></table></figure>

<ul>
<li>创建 <code>requirements.txt</code></li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">flask</span><br><span class="hljs-attribute">redis</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>编写 Dockerfile</li>
</ol>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> python:<span class="hljs-number">3.7</span>-alpine<br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /code</span><br><span class="hljs-keyword">ENV</span> FLASK_APP=app.py<br><span class="hljs-keyword">ENV</span> FLASK_RUN_HOST=<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apk add --no-cache gcc musl-dev linux-headers</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> requirements.txt requirements.txt</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> pip install -r requirements.txt</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">5000</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;flask&quot;</span>, <span class="hljs-string">&quot;run&quot;</span>]</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li>定义<code>docker-compose.yml</code></li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3.8&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">web:</span><br>    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;5000:5000&quot;</span><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">&quot;redis:alpine&quot;</span><br></code></pre></td></tr></table></figure>

<ol start="4">
<li>启动并访问服务</li>
</ol>
<ul>
<li>启动</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker-compose up</span><br><br>Creating network &quot;composetest_default&quot; with the default driver<br>Creating composetest_web_1 ...<br>Creating composetest_redis_1 ...<br>Creating composetest_web_1<br>Creating composetest_redis_1 ... done<br>Attaching to composetest_web_1, composetest_redis_1<br>web_1    |  * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)<br>redis_1  | 1:C 17 Aug 22:11:10.480 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo<br>redis_1  | 1:C 17 Aug 22:11:10.480 # Redis version=4.0.1, bits=64, commit=00000000, modified=0, pid=1, just started<br>redis_1  | 1:C 17 Aug 22:11:10.480 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf<br>web_1    |  * Restarting with stat<br>redis_1  | 1:M 17 Aug 22:11:10.483 * Running mode=standalone, port=6379.<br>redis_1  | 1:M 17 Aug 22:11:10.483 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.<br>web_1    |  * Debugger is active!<br>redis_1  | 1:M 17 Aug 22:11:10.483 # Server initialized<br>redis_1  | 1:M 17 Aug 22:11:10.483 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command &#x27;echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled&#x27; as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.<br>web_1    |  * Debugger PIN: 330-787-903<br>redis_1  | 1:M 17 Aug 22:11:10.483 * Ready to accept connections<br></code></pre></td></tr></table></figure>

<ul>
<li>访问 <a target="_blank" rel="noopener" href="http://localhost:5000/">http://localhost:5000/</a></li>
</ul>
<p>5 、停止</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@server1 composetest]# docker-compose down<br>Stopping composetest_web_1   ... done<br>Stopping composetest_redis_1 ... done<br>Removing composetest_web_1   ... done<br>Removing composetest_redis_1 ... done<br>Removing network composetest_default<br>[root@server1 composetest]#<br></code></pre></td></tr></table></figure>

<h2><span id="解释">解释</span></h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> 默认网卡：文件夹名\<span class="hljs-emphasis">_default，这样都在同一网段，可以通过域名访问</span><br><span class="hljs-emphasis">- 默认服务名：文件夹名\_</span>服务名\<span class="hljs-emphasis">_num （num：副本数量）</span><br><span class="hljs-emphasis">- 一般都是集群部署，不会只有一个实例</span><br></code></pre></td></tr></table></figure>

<h2><span id="docker-composeyml-编写规则">docker-compose.yml 编写规则</span></h2><blockquote>
<p>文档地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/compose-file/">https://docs.docker.com/compose/compose-file/</a></p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># 1、版本</span><br><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment"># 2、服务</span><br><span class="hljs-attr">services:</span><br>	<span class="hljs-string">服务1:</span><br>		<span class="hljs-string">xxx</span><br>		<span class="hljs-string">xxx</span><br>	<span class="hljs-string">服务2:</span><br>	  <span class="hljs-string">xxx</span><br>	  <span class="hljs-string">xxx</span><br><br><span class="hljs-comment"># 其他：网络/卷/全局规则</span><br></code></pre></td></tr></table></figure>

<h2><span id="例子个人博客">例子：个人博客</span></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># 创建目录m y_wordpress</span><br><span class="hljs-string">mkdir</span> <span class="hljs-string">my_wordpress</span><br><br><span class="hljs-comment"># 创建docker-compose.yml</span><br><span class="hljs-string">cd</span> <span class="hljs-string">my_wordpress</span><br><span class="hljs-string">vim</span> <span class="hljs-string">docker-compose.yml</span><br><br><br><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.3&#x27;</span><br><span class="hljs-attr">services:</span><br>   <span class="hljs-attr">db:</span><br>     <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:5.7</span><br>     <span class="hljs-attr">volumes:</span><br>       <span class="hljs-bullet">-</span> <span class="hljs-string">db_data:/var/lib/mysql</span><br>     <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>     <span class="hljs-attr">environment:</span><br>       <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">somewordpress</span><br>       <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">wordpress</span><br>       <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">wordpress</span><br>       <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">wordpress</span><br>   <span class="hljs-attr">wordpress:</span><br>     <span class="hljs-attr">depends_on:</span><br>       <span class="hljs-bullet">-</span> <span class="hljs-string">db</span><br>     <span class="hljs-attr">image:</span> <span class="hljs-string">wordpress:latest</span><br>     <span class="hljs-attr">ports:</span><br>       <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8000:80&quot;</span><br>     <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>     <span class="hljs-attr">environment:</span><br>       <span class="hljs-attr">WORDPRESS_DB_HOST:</span> <span class="hljs-string">db:3306</span><br>       <span class="hljs-attr">WORDPRESS_DB_USER:</span> <span class="hljs-string">wordpress</span><br>       <span class="hljs-attr">WORDPRESS_DB_PASSWORD:</span> <span class="hljs-string">wordpress</span><br>       <span class="hljs-attr">WORDPRESS_DB_NAME:</span> <span class="hljs-string">wordpress</span><br><span class="hljs-attr">volumes:</span><br>    <span class="hljs-attr">db_data:</span> &#123;&#125;<br><br><span class="hljs-comment"># 运行</span><br><span class="hljs-string">docker-compose</span> <span class="hljs-string">up</span> <span class="hljs-string">-d</span><br><br><span class="hljs-comment"># 访问</span><br><span class="hljs-string">aly:8000</span><br></code></pre></td></tr></table></figure>

<h2><span id="容器部署个人微服务">容器部署个人微服务</span></h2><h1><span id="docker-swarm">Docker Swarm</span></h1><blockquote>
<p>集群方式的部署</p>
</blockquote>
<h1><span id="cix2fcd-之-jenkins">CI&#x2F;CD 之 Jenkins</span></h1>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2020-12-07-Docker教程</div>
      <div>https://polarisink.github.io/2022/08/13/yuque/2020-12-07-Docker教程/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Areis</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月13日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/13/yuque/2020-12-07-JUC%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%8F%8A%E9%AB%98%E5%B9%B6%E5%8F%91/" title="2020-12-07-JUC多线程及高并发">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2020-12-07-JUC多线程及高并发</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/13/yuque/2020-12-07-%E7%8E%8B%E5%8D%93%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="2020-12-07-王卓数据结构与算法">
                        <span class="hidden-mobile">2020-12-07-王卓数据结构与算法</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
